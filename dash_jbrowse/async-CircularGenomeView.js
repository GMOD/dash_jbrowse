(window.webpackJsonpdash_jbrowse=window.webpackJsonpdash_jbrowse||[]).push([[2],{8:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(40),i=n(24),c=n(25),s=n(73),u=n(475),l=n(1179),g=n(1216),f=n(497),p=n(503),d=n(494),m=n(496),b=n(48),v=n(1174),y=n(1221),h=n(52),w=n(239),O=n.n(w),j=n(574),E=n(28),S=n(575),C=n.n(S),k=n(578),T=n.n(k),M=n(599),P=n.n(M),R=n(603),W=n.n(R),D=n(401),x=n(684),N=n(677),I=n(689),A=n(686),V=n(397),_=n(682),q=n.n(_),B=n(678),J=n.n(B),z=n(45),F=(n(679),Object(u.a)({paper:{overflow:"auto"}})),G=Object(o.observer)((function(e){var t=e.session,n=t.visibleWidget;if(!n)return a.a.createElement(l.a,{position:"relative"},a.a.createElement(g.a,null));var o=Object(i.getEnv)(t).pluginManager.getWidgetType(n.type),c=o.ReactComponent,s=o.HeadingComponent,u=o.heading;return a.a.createElement(a.a.Fragment,null,a.a.createElement(l.a,{position:"static"},a.a.createElement(g.a,null,s?a.a.createElement(s,{model:n}):a.a.createElement(f.a,{variant:"h6"},u))),n&&c?a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"Loading...")},a.a.createElement(y.a,null,a.a.createElement(c,{model:n,session:t,overrideDimensions:{height:5*window.innerHeight/8,width:800}}))):null)})),L=Object(o.observer)((function(e){var t=e.session,n=F(),r=t.visibleWidget,o=t.hideAllWidgets;return a.a.createElement(p.a,{open:Boolean(r),onClose:o,maxWidth:"xl"},a.a.createElement(d.a,{className:n.paper},a.a.createElement(G,{session:t})))})),H=Object(u.a)((function(e){return{viewContainer:{overflow:"hidden",background:e.palette.secondary.main,margin:e.spacing(1)},icon:{color:e.palette.secondary.contrastText},displayName:{marginTop:2,color:e.palette.secondary.contrastText},grow:{flexGrow:1},iconRoot:{"&:hover":{backgroundColor:Object(h.a)(e.palette.secondary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}}})),K=Object(o.observer)((function(e){var t,n=e.model,o=e.IconButtonProps,i=e.IconProps,c=Object(r.useState)(),u=c[0],l=c[1];return null!=(t=n.menuItems())&&t.length?a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,Object.assign({},o,{"aria-label":"more","aria-controls":"view-menu","aria-haspopup":"true",onClick:function(e){l(e.currentTarget)},"data-testid":"view_menu_icon"}),a.a.createElement(O.a,Object.assign({},i))),a.a.createElement(s.Menu,{anchorEl:u,open:Boolean(u),onMenuItemClick:function(e,t){t(),l(void 0)},onClose:function(){l(void 0)},menuItems:n.menuItems()})):null})),Q=Object(o.observer)((function(e){var t=e.view,n=e.children,o=H(),c=Object(b.a)(),u=Object(E.getSession)(t),l=Object(j.a)(),g=l[0],p=l[1].width,m=c.spacing(1);return Object(r.useEffect)((function(){p&&Object(i.isAlive)(t)&&t.setWidth(p-2*m)}),[m,t,p]),a.a.createElement(d.a,{elevation:12,ref:g,className:o.viewContainer,style:{padding:"0px "+m+"px "+m+"px"}},u.DialogComponent?a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null)},a.a.createElement(u.DialogComponent,Object.assign({},u.DialogProps))):null,a.a.createElement("div",{style:{display:"flex"}},a.a.createElement(K,{model:t,IconButtonProps:{classes:{root:o.iconRoot},edge:"start"},IconProps:{className:o.icon}}),a.a.createElement("div",{className:o.grow}),t.displayName?a.a.createElement(f.a,{variant:"body2",className:o.displayName},t.displayName):null,a.a.createElement("div",{className:o.grow}),a.a.createElement("div",{style:{width:20,height:20}},a.a.createElement(s.Logomark,{variant:"white"}))),a.a.createElement(d.a,null,n))})),U=Object(u.a)((function(){return{avoidParentStyle:{all:"initial"}}})),X=Object(o.observer)((function(e){var t=e.viewState,n=U(),o=t.session,u=o.view,l=Object(i.getEnv)(o).pluginManager.getViewType(u.type);if(!l)throw new Error("unknown view type "+u.type);var g=l.ReactComponent,f=Object(s.createJBrowseTheme)(Object(c.readConfObject)(t.config.configuration,"theme"));return a.a.createElement(v.a,{theme:f},a.a.createElement("div",{className:n.avoidParentStyle},a.a.createElement(y.a,null,a.a.createElement(Q,{key:"view-"+u.id,view:u},a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"Loading...")},a.a.createElement(g,{model:u,session:o}))),a.a.createElement(L,{session:o}))))})),Y=[D.b,x.a,N.d,I.a,A.a,V.f];function Z(e,t){return i.types.model("Configuration",{configuration:Object(c.ConfigurationSchema)("Root",{rpc:P.a.configSchema,highResolutionScaling:{type:"number",defaultValue:2},theme:{type:"frozen",defaultValue:{}}}),assembly:t,tracks:i.types.array(e.pluggableConfigSchemaType("track")),connections:i.types.array(e.pluggableConfigSchemaType("connection")),aggregateTextSearchAdapters:i.types.array(e.pluggableConfigSchemaType("text search adapter")),plugins:i.types.frozen()}).views((function(e){return{get assemblies(){return[e.assembly]},get assemblyName(){return Object(c.readConfObject)(e.assembly,"name")},get rpcManager(){return Object(i.getParent)(e).rpcManager}}}))}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ee=Object(r.lazy)((function(){return n.e(0).then(n.t.bind(null,1222,7))}));function te(e){var t=new T.a([].concat(Y,e).map((function(e){return new e})));t.createPluggableElements();var n=function(e){var t=i.types.model("ReactCircularGenomeViewSession",{name:i.types.identifier,view:e.getViewType("CircularView").stateModel,widgets:i.types.map(e.pluggableMstType("widget","stateModel")),activeWidgets:i.types.map(i.types.safeReference(e.pluggableMstType("widget","stateModel"))),connectionInstances:i.types.array(e.pluggableMstType("connection","stateModel"))}).volatile((function(){return{selection:void 0,task:void 0,queueOfDialogs:[]}})).views((function(e){return{get DialogComponent(){if(e.queueOfDialogs.length){var t=e.queueOfDialogs[0];return t&&t[0]}},get DialogProps(){if(e.queueOfDialogs.length){var t=e.queueOfDialogs[0];return t&&t[1]}},get rpcManager(){return Object(i.getParent)(e).rpcManager},get configuration(){return Object(i.getParent)(e).config.configuration},get assemblies(){return[Object(i.getParent)(e).config.assembly]},get assemblyNames(){return[Object(i.getParent)(e).config.assemblyName]},get tracks(){return Object(i.getParent)(e).config.tracks},get aggregateTextSearchAdapters(){return Object(i.getParent)(e).config.aggregateTextSearchAdapters},get connections(){return Object(i.getParent)(e).config.connections},get adminMode(){return!1},get assemblyManager(){return Object(i.getParent)(e).assemblyManager},get version(){return""},get views(){return[e.view]},renderProps:function(){return{theme:Object(c.readConfObject)(this.configuration,"theme")}},get visibleWidget(){if(Object(i.isAlive)(e))return Array.from(e.activeWidgets.values())[e.activeWidgets.size-1]},getReferring:function(t){var n=[];return Object(i.walk)(Object(i.getParent)(e),(function(e){if(Object(i.isModelType)(Object(i.getType)(e))){var r=Object(i.getMembers)(e);Object.entries(r.properties).forEach((function(r){var a=r[0],o=r[1];Object(i.isReferenceType)(o)&&e[a]===t&&n.push({node:e,key:a})}))}})),n}}})).actions((function(t){return{queueDialog:function(e){var n=this,r=e((function(){n.removeActiveDialog()})),a=r[0],o=r[1];t.queueOfDialogs=[].concat(t.queueOfDialogs,[[a,o]])},removeActiveDialog:function(){t.queueOfDialogs=t.queueOfDialogs.slice(1)},makeConnection:function(n,r){void 0===r&&(r={});var a=n.type;if(!a)throw new Error("track configuration has no `type` listed");var o=Object(c.readConfObject)(n,"name");if(!e.getConnectionType(a))throw new Error("unknown connection type "+a);var i=$({},r,{name:o,type:a,configuration:n}),s=t.connectionInstances.push(i);return t.connectionInstances[s-1]},removeReferring:function(e,t,n,r){var a=this;e.forEach((function(e){var o=e.node,c=!1;try{var s="open track(s)",u=Object(E.getContainingView)(o);n.push((function(){return u.hideTrack(t.trackId)})),c=!0,r[s]||(r[s]=0),r[s]+=1}catch(e){}if(a.hasWidget(o)){var l="configuration editor widget(s)";n.push((function(){return a.hideWidget(o)})),c=!0,r[l]||(r[l]=0),r[l]+=1}if(!c)throw new Error("Error when closing this connection, the following node is still referring to a track configuration: "+JSON.stringify(Object(i.getSnapshot)(o)))}))},prepareToBreakConnection:function(e){var n=this,r=[],a={},o=Object(c.readConfObject)(e,"name");t.connectionInstances.find((function(e){return e.name===o})).tracks.forEach((function(e){var o=t.getReferring(e);n.removeReferring(o,e,r,a)}));return[function(){r.forEach((function(e){return e()})),n.breakConnection(e)},a]},breakConnection:function(e){var n=Object(c.readConfObject)(e,"name"),r=t.connectionInstances.find((function(e){return e.name===n}));t.connectionInstances.remove(r)},addView:function(n,r){if(void 0===r&&(r={}),!e.getElementType("view",n))throw new Error("unknown view type "+n);t.view=$({},r,{type:n})},removeView:function(){},addWidget:function(n,r,a,o){if(void 0===a&&(a={}),void 0===o&&(o={type:n}),!e.getElementType("widget",n))throw new Error("unknown widget type "+n);var i=$({},a,{id:r,type:n,configuration:o});return t.widgets.set(r,i),t.widgets.get(r)},showWidget:function(e){t.activeWidgets.has(e.id)&&t.activeWidgets.delete(e.id),t.activeWidgets.set(e.id,e)},hasWidget:function(e){return t.activeWidgets.has(e.id)},hideWidget:function(e){t.activeWidgets.delete(e.id)},hideAllWidgets:function(){t.activeWidgets.clear()},setSelection:function(e){t.selection=e},clearSelection:function(){t.selection=void 0},clearConnections:function(){t.connectionInstances.length=0},renameCurrentSession:function(e){return Object(i.getParent)(t).renameCurrentSession(e)}}})).views((function(e){return{getTrackActionMenuItems:function(t){return[{label:"About track",onClick:function(){e.queueDialog((function(e){return[ee,{config:t,handleClose:e}]}))},icon:q.a}]}}}));return J()(t)}(t),r=Object(S.assemblyConfigSchemaFactory)(t),a=C()(r,t);return{model:i.types.model("ReactCircularGenomeView",{config:Z(t,r),session:n,assemblyManager:a}).volatile((function(){return{error:void 0}})).actions((function(e){return{setSession:function(t){e.session=Object(i.cast)(t)},renameCurrentSession:function(t){if(e.session){var n=JSON.parse(JSON.stringify(Object(i.getSnapshot)(e.session)));n.name=t,this.setSession(n)}},setError:function(t){e.error=t}}})).views((function(e){return{get jbrowse(){return e.config},get pluginManager(){return t}}})).volatile((function(e){return{rpcManager:new P.a(t,e.config.configuration.rpc,{MainThreadRpcDriver:{}}),textSearchManager:new W.a(t)}})),pluginManager:t}}var ne=n(4);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ue(e);if(t){var a=ue(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return se(this,n)}}function se(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"default",(function(){return le}));var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(c,e);var t,n,r,o=ce(c);function c(){return ae(this,c),o.apply(this,arguments)}return t=c,(n=[{key:"render",value:function(){var e=this.props,t=e.id,n=function(e){var t=e.assembly,n=e.tracks,r=e.configuration,a=e.aggregateTextSearchAdapters,o=e.plugins,c=e.onChange,s=te(o||[]),u=s.model,l=s.pluginManager,g=e.defaultSession;g||(g={name:"this session",view:{id:"circularView",type:"CircularView"}});var f={config:{configuration:r,assembly:t,tracks:n,aggregateTextSearchAdapters:a,defaultSession:g},assemblyManager:{},session:g},p=u.create(f,{pluginManager:l});return l.setRootModel(p),l.configure(),Object(z.autorun)((function(e){if(p.assemblyManager.allPossibleRefNames&&p.assemblyManager.allPossibleRefNames.length&&p.session.view.initialized){var t=p.assemblyManager.assemblies[0];p.session.view.setDisplayedRegions(t.regions),e.dispose()}})),c&&Object(i.onPatch)(p,c),p}({assembly:e.assembly,tracks:e.tracks,defaultSession:e.defaultSession,aggregateTextSearchAdapters:e.aggregateTextSearchAdapters,configuration:e.configuration});return a.a.createElement("div",{id:t},a.a.createElement(X,{viewState:n}))}}])&&oe(t.prototype,n),r&&oe(t,r),c}(r.Component);le.defaultProps=ne.b,le.propTypes=ne.c}}]);
//# sourceMappingURL=async-CircularGenomeView.js.map
//# sourceMappingURL=async-CircularGenomeView.js.map