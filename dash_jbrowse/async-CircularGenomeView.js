(window.webpackJsonpdash_jbrowse=window.webpackJsonpdash_jbrowse||[]).push([[2],{8:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return me}));var a=n(1),r=n.n(a),o=n(20),i=n(21),s=n(13),c=n(43),l=n(1355),u=n(718),g=n(22),p=n(98),d=n(196),f=n(664),m=n(741),b=n(663),y=n(684),v=n(510);const h=Object(g.makeStyles)()({paper:{overflow:"auto"}}),w=Object(o.observer)((({session:e})=>{const{visibleWidget:t}=e;if(!t)return r.a.createElement(f.a,{position:"relative"},r.a.createElement(m.a,null));const{ReactComponent:n,HeadingComponent:o,heading:s}=Object(i.getEnv)(e).pluginManager.getWidgetType(t.type);return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{position:"static"},r.a.createElement(m.a,null,o?r.a.createElement(o,{model:t}):r.a.createElement(b.a,{variant:"h6"},s))),t&&n?r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null,"Loading...")},r.a.createElement(u.a,null,r.a.createElement(n,{model:t,session:e,overrideDimensions:{height:5*window.innerHeight/8,width:800}}))):null)}));var O=Object(o.observer)((({session:e})=>{const{classes:t}=h(),{visibleWidget:n,hideAllWidgets:a}=e;return r.a.createElement(y.a,{open:Boolean(n),onClose:a,maxWidth:"xl"},r.a.createElement(v.a,{className:t.paper},r.a.createElement(w,{session:e})))})),j=n(1283),E=n(660),S=n(46),k=n(435),C=n.n(k),T=n(544),M=n(17);const P=Object(a.lazy)((()=>n.e(0).then(n.bind(null,1339)))),R=Object(g.makeStyles)()((e=>({viewContainer:{overflow:"hidden",background:e.palette.secondary.main,margin:e.spacing(.5)},icon:{color:e.palette.secondary.contrastText},displayName:{marginTop:2,color:e.palette.secondary.contrastText},grow:{flexGrow:1},iconRoot:{"&:hover":{backgroundColor:Object(j.a)(e.palette.secondary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}}))),W=Object(o.observer)((({model:e,IconButtonProps:t,IconProps:n})=>{var o;const[i,s]=Object(a.useState)();return(null===(o=e.menuItems())||void 0===o?void 0:o.length)?r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{...t,"aria-label":"more","aria-controls":"view-menu","aria-haspopup":"true",onClick:e=>s(e.currentTarget),"data-testid":"view_menu_icon"},r.a.createElement(C.a,{...n})),r.a.createElement(c.Menu,{anchorEl:i,open:Boolean(i),onMenuItemClick:(e,t)=>{t(),s(void 0)},onClose:()=>s(void 0),menuItems:e.menuItems()})):null}));var D=Object(o.observer)((({view:e,children:t})=>{const{classes:n}=R(),o=Object(S.a)(),s=Object(M.getSession)(e),[l,u]=Object(a.useState)(!1),[g,{width:p}]=Object(T.default)(),d=o.spacing(1);return Object(a.useEffect)((()=>{p&&Object(i.isAlive)(e)&&e.setWidth(p-2*parseInt(d,10))}),[d,e,p]),r.a.createElement(v.a,{elevation:12,ref:g,className:n.viewContainer,style:{padding:`0px ${d} ${d}`}},s.DialogComponent?r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(s.DialogComponent,{...s.DialogProps})):null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(W,{model:e,IconButtonProps:{classes:{root:n.iconRoot},edge:"start"},IconProps:{className:n.icon}}),r.a.createElement("div",{className:n.grow}),e.displayName?r.a.createElement(b.a,{variant:"body2",className:n.displayName},e.displayName):null,r.a.createElement("div",{className:n.grow}),r.a.createElement(E.a,{onClick:()=>u(!0)},r.a.createElement("div",{style:{width:22,height:22}},r.a.createElement(c.Logomark,{variant:"white"})))),r.a.createElement(v.a,null,t),l?r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(P,{open:!0,onClose:()=>u(!1)})):null)}));const x=Object(g.makeStyles)()({avoidParentStyle:{all:"initial"}}),N=Object(d.default)({key:"mui",prepend:!0});var I=Object(o.observer)((({viewState:e})=>{const{classes:t}=x(),{session:n}=e,{view:o}=n,{pluginManager:g}=Object(i.getEnv)(n),d=g.getViewType(o.type);if(!d)throw new Error(`unknown view type ${o.type}`);const{ReactComponent:f}=d,m=Object(c.createJBrowseTheme)(Object(s.readConfObject)(e.config.configuration,"theme"));return r.a.createElement(p.a,{value:N},r.a.createElement(l.a,{theme:m},r.a.createElement("div",{className:t.avoidParentStyle},r.a.createElement(u.a,null,r.a.createElement(D,{key:`view-${o.id}`,view:o},r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null,"Loading...")},r.a.createElement(f,{model:o,session:n}))),r.a.createElement(O,{session:n})))))})),A=n(780),V=n.n(A),_=n(783),q=n.n(_),B=n(466),$=n.n(B),J=n(831),z=n.n(J),F=n(482),G=n(897),L=n(629),H=n(896),K=n(898),Q=n(147);var U=[F.b,G.a,L.d,H.a,K.a,Q.f];function X(e,t){return i.types.model("Configuration",{configuration:Object(s.ConfigurationSchema)("Root",{rpc:$.a.configSchema,highResolutionScaling:{type:"number",defaultValue:2},theme:{type:"frozen",defaultValue:{}}}),assembly:t,tracks:i.types.array(e.pluggableConfigSchemaType("track")),connections:i.types.array(e.pluggableConfigSchemaType("connection")),aggregateTextSearchAdapters:i.types.array(e.pluggableConfigSchemaType("text search adapter")),plugins:i.types.frozen()}).views((e=>({get assemblies(){return[e.assembly]},get assemblyName(){return Object(s.readConfObject)(e.assembly,"name")},get rpcManager(){return Object(i.getParent)(e).rpcManager}})))}var Y=n(844),Z=n.n(Y),ee=n(845),te=n.n(ee),ne=n(842),ae=n.n(ne),re=n(847);function oe(e){const t=new q.a([...U,...e].map((e=>new e)));t.createPluggableElements();const n=function(e){const t=i.types.model("ReactCircularGenomeViewSession",{name:i.types.identifier,view:e.getViewType("CircularView").stateModel,widgets:i.types.map(e.pluggableMstType("widget","stateModel")),activeWidgets:i.types.map(i.types.safeReference(e.pluggableMstType("widget","stateModel"))),connectionInstances:i.types.array(e.pluggableMstType("connection","stateModel"))}).volatile((()=>({selection:void 0,task:void 0,queueOfDialogs:[]}))).views((e=>({get DialogComponent(){if(e.queueOfDialogs.length){const t=e.queueOfDialogs[0];return t&&t[0]}},get DialogProps(){if(e.queueOfDialogs.length){const t=e.queueOfDialogs[0];return t&&t[1]}},get rpcManager(){return Object(i.getParent)(e).rpcManager},get configuration(){return Object(i.getParent)(e).config.configuration},get assemblies(){return[Object(i.getParent)(e).config.assembly]},get assemblyNames(){return[Object(i.getParent)(e).config.assemblyName]},get tracks(){return Object(i.getParent)(e).config.tracks},get aggregateTextSearchAdapters(){return Object(i.getParent)(e).config.aggregateTextSearchAdapters},get connections(){return Object(i.getParent)(e).config.connections},get adminMode(){return!1},get assemblyManager(){return Object(i.getParent)(e).assemblyManager},get version(){return re.a},get views(){return[e.view]},renderProps(){return{theme:Object(s.readConfObject)(this.configuration,"theme")}},get visibleWidget(){if(Object(i.isAlive)(e))return Array.from(e.activeWidgets.values())[e.activeWidgets.size-1]},getReferring(t){const n=[];return Object(i.walk)(Object(i.getParent)(e),(e=>{if(Object(i.isModelType)(Object(i.getType)(e))){const a=Object(i.getMembers)(e);Object.entries(a.properties).forEach((([a,r])=>{Object(i.isReferenceType)(r)&&e[a]===t&&n.push({node:e,key:a})}))}})),n}}))).actions((t=>({queueDialog(e){const[n,a]=e((()=>{this.removeActiveDialog()}));t.queueOfDialogs=[...t.queueOfDialogs,[n,a]]},removeActiveDialog(){t.queueOfDialogs=t.queueOfDialogs.slice(1)},makeConnection(n,a={}){const{type:r}=n;if(!r)throw new Error("track configuration has no `type` listed");const o=Object(s.readConfObject)(n,"name");if(!e.getConnectionType(r))throw new Error(`unknown connection type ${r}`);const i={...a,name:o,type:r,configuration:n},c=t.connectionInstances.push(i);return t.connectionInstances[c-1]},removeReferring(e,t,n,a){e.forEach((({node:e})=>{let r=!1;try{const o="open track(s)",i=Object(M.getContainingView)(e);n.push((()=>i.hideTrack(t.trackId))),r=!0,a[o]||(a[o]=0),a[o]+=1}catch(e){}if(this.hasWidget(e)){const t="configuration editor widget(s)";n.push((()=>this.hideWidget(e))),r=!0,a[t]||(a[t]=0),a[t]+=1}if(!r)throw new Error(`Error when closing this connection, the following node is still referring to a track configuration: ${JSON.stringify(Object(i.getSnapshot)(e))}`)}))},prepareToBreakConnection(e){const n=[],a={},r=Object(s.readConfObject)(e,"name");return t.connectionInstances.find((e=>e.name===r)).tracks.forEach((e=>{const r=t.getReferring(e);this.removeReferring(r,e,n,a)})),[()=>{n.forEach((e=>e())),this.breakConnection(e)},a]},breakConnection(e){const n=Object(s.readConfObject)(e,"name"),a=t.connectionInstances.find((e=>e.name===n));t.connectionInstances.remove(a)},addView(n,a={}){if(!e.getElementType("view",n))throw new Error(`unknown view type ${n}`);return t.view={...a,type:n},t.view},removeView(){},addWidget(n,a,r={},o={type:n}){if(!e.getElementType("widget",n))throw new Error(`unknown widget type ${n}`);const i={...r,id:a,type:n,configuration:o};return t.widgets.set(a,i),t.widgets.get(a)},showWidget(e){t.activeWidgets.has(e.id)&&t.activeWidgets.delete(e.id),t.activeWidgets.set(e.id,e)},hasWidget:e=>t.activeWidgets.has(e.id),hideWidget(e){t.activeWidgets.delete(e.id)},hideAllWidgets(){t.activeWidgets.clear()},setSelection(e){t.selection=e},clearSelection(){t.selection=void 0},clearConnections(){t.connectionInstances.length=0},renameCurrentSession:e=>Object(i.getParent)(t).renameCurrentSession(e)}))).views((e=>({getTrackActionMenuItems:t=>[{label:"About track",onClick:()=>{e.queueDialog((e=>[Z.a,{config:t,handleClose:e}]))},icon:te.a}]})));return ae()(t)}(t),a=Object(A.assemblyConfigSchemaFactory)(t),r=V()(a,t);return{model:i.types.model("ReactCircularGenomeView",{config:X(t,a),session:n,assemblyManager:r}).volatile((()=>({error:void 0}))).actions((e=>({setSession(t){e.session=Object(i.cast)(t)},renameCurrentSession(t){if(e.session){const n=JSON.parse(JSON.stringify(Object(i.getSnapshot)(e.session)));n.name=t,this.setSession(n)}},setError(t){e.error=t}}))).views((e=>({get jbrowse(){return e.config},get pluginManager(){return t}}))).volatile((e=>({rpcManager:new $.a(t,e.config.configuration.rpc,{MainThreadRpcDriver:{}}),textSearchManager:new z.a(t)}))),pluginManager:t}}var ie=n(38);n(846);var se=n(4);function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ge(e,t){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ge(e,t)}function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=fe(e);if(t){var r=fe(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return de(this,n)}}function de(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}var me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t)}(s,e);var t,n,a,o=pe(s);function s(){return le(this,s),o.apply(this,arguments)}return t=s,(n=[{key:"render",value:function(){var e=this.props,t=e.id,n=function(e){const{assembly:t,tracks:n,configuration:a,aggregateTextSearchAdapters:r,plugins:o,onChange:s}=e,{model:c,pluginManager:l}=oe(o||[]);let{defaultSession:u}=e;u||(u={name:"this session",view:{id:"circularView",type:"CircularView"}});const g={config:{configuration:a,assembly:t,tracks:n,aggregateTextSearchAdapters:r,defaultSession:u},assemblyManager:{},session:u},p=c.create(g,{pluginManager:l});return l.setRootModel(p),l.configure(),Object(ie.autorun)((e=>{if(p.assemblyManager.allPossibleRefNames&&p.assemblyManager.allPossibleRefNames.length&&p.session.view.initialized){const t=p.assemblyManager.assemblies[0];p.session.view.setDisplayedRegions(t.regions),e.dispose()}})),s&&Object(i.onPatch)(p,s),p}({assembly:e.assembly,tracks:e.tracks,defaultSession:e.defaultSession,aggregateTextSearchAdapters:e.aggregateTextSearchAdapters,configuration:e.configuration});return r.a.createElement("div",{id:t},r.a.createElement(I,{viewState:n}))}}])&&ue(t.prototype,n),a&&ue(t,a),Object.defineProperty(t,"prototype",{writable:!1}),s}(a.Component);me.defaultProps=se.b,me.propTypes=se.c},847:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="2.1.5"}}]);
//# sourceMappingURL=async-CircularGenomeView.js.map
//# sourceMappingURL=async-CircularGenomeView.js.map